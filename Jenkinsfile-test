
pipeline {

  agent {label 'macagent'}
  stages {
    
    
    //Installs the apk to the test device and runs the appium tests
    stage('Install & Test'){


      steps{
          sh 'chmod +x gradlew && ./gradlew clean && ./gradlew assembleDebug'
          dir('appium-test'){
            
            sh 'sh test.sh'
            sh './gradlew clean && ./gradlew test'
          }
      }
    }
    
  
    //Push APK to cloud for testing on multiple devices

    stage('Proceed to Cloud Testing'){
        steps{
          input 'Promote to Cloud For Testing'
        }
    } 

    stage('Uploading APK'){
      steps{
          sh 'sleep 600'      
      }
    }

  }//end stages
   /*post {
    always {
      cleanWs()
    }
  }*/
}//end pipeline


